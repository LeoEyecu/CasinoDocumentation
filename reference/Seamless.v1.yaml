## Presentation of the Seamless

In this article we will see how the seamless flow is working.

You will have to give us an endpoint from your system (GET Endpoint). This endpoint need to be always available, otherwise the games will not work.

Let's take an example, as your endpoint will be : https://www.casino.pro/seamless


### Events list
<!-- title: Events list -->

| Event Name |      Require answer |   Description |
| ------------- | :-----------: | -----: |
| getBalance      | YES | Retrive the balance of the user |
| updateBalance      |   NO |   Update the balance of the user |
| gameStats |   NO    |   Send a round statistic (bet, win, profit etc) |
| gameLog |   NO    |   Send a log of the game played (game id, user id, ip etc) |
| jackpotUpdate |   NO    |  Send a jackpot update for the player |
| gameError |   NO    |   Send an error log if the game have any problem |

### Generate a Seamless token

To generate a valid user Token, you will have to provide 2 things :

<!-- title: Elements to provide -->
| Param | Example | Description |
| ------ | ------- | --------- |
|user_id | 1 | The user id in YOUR internal system (it will be in use when the games send requests to your system) |
| time | 1598117021 | Current timestamp |

To be able to generate the seamless token, you need your IPN Secret. You can get it direlcty in your Shop Configuration

#### Token  generator

To be able to know the user id needed to play with, the system need to be able to read your token (decrypt it)

For this, we use 'openssl' for the encryption / decryption with the 'aes-125-ctr' method.

The IV for this encryption will be pHb33yWGCN4qfX7V, always.

The string required in this token encryption have this format :

\```json
user_id="YOUR_USER_ID",time="TIMESTAMP"
\```


Now after we have all these information, we can write our function

(PHP)

\```php
$cipher_method = 'aes-128-ctr';
$crypted_token = openssl_encrypt('user_id=10,time=1598117021', $cipher_method, "YOUR IPN SECRET", 0, 'pHb33yWGCN4qfX7V');
$seamless_token = base64_encode($crypted_token);
var_dump($seamless_token);
\```
